<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Trivia</title>
    <style>
    .content {
        width: 500px;
        height: 500px;
        background: orange;
        margin: 0 auto;
    }
    
    h1 {
        text-align: center;
    }
    
    #start {
        display: block;
        margin: 0 auto;
    }
    
    #start {
        border: solid red 2px;
    }
    
    #wrapper,
    #info-panel {
        margin: 0 auto;
    }
    
    #wrapper {
        display: none;
        background: yellow;
        width: 400px;
        height: 200px;
    }
    
    #info-panel {
        display: none;
        background: yellow;
        width: 400px;
        height: 200px;
    }
    </style>
</head>

<body>
    <div class="content">
        <h1>Trivia</h1>
        <button id="start">START</button>
        <div id="wrapper">
            <p id="question"></p>
            <ul id="answers">
            </ul>
            <div id="next">NEXT</div>
            <div id="countdown"></div>
        </div>
        <!-- wrapper -->
        <div id="info-panel">Hello!</div>
    </div>
    <!-- content -->
    <!--content-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script>
    //function that constructs my questions into objects//

    function Question(questionNumber, questionString, answerChoices, answerIndex) {
        this.questionNumber = questionNumber;
        this.questionString = questionString;
        this.answerChoices = answerChoices;
        this.answerIndex = answerIndex;
    }

    var questionBank = [
        new Question(1, "What is 2+2?", [4, 3, 15, "none of the above"], "0"),
        new Question(2, "What is the word cat?", ["cat", 3, "dog", "none of the above"], "0"),
        new Question(3, "Which is q?", [4, "v", "q", "none of the above"], "2"),
    ]

    var quesNumCounter = 0;


    //shorthand for jquery document ready function//
    $(function() {


        var $wrapper = $("#wrapper");
        var $start = $("#start");
        var $question = $("#question");
        var $next = $("#next");
        var $answers = $("#answers");
        var timerStop = false;
        var correctGuess = 0;
        var incorrectGuess = 0;
        var unansweredGuess = 0;



        //countdown timer//

        function startTimer() {
            var count = 16;
            timerStop = false;
            timer();
            var counter = setInterval(timer, 1000); //timer function will  run every 1 second

            function timer() {
                count--;
                if (timerStop === true) {
                    clearInterval(counter);
                    return;

                } else if (count <= 0) {
                    clearInterval(counter);
                    timeUp();
                    return;
                }

                $("#countdown").html("Timer: " + count)
            }
        }


        $start.on("click", function() {
            quesNumCounter = 0;
            $(this).hide();
            $("#info-panel").hide();
            $wrapper.show();
            generateQuestion(quesNumCounter);
            startTimer();


        });



        function nextQuestion() {
            $("#info-panel").hide();

            if (quesNumCounter == questionBank.length - 1) {
                endScreen();
            } else {
                quesNumCounter++
                $wrapper.show();
                generateQuestion(quesNumCounter)
                startTimer();

            }
        };

        //matching the data attribute to our correct answer index
        $answers.on("click", "li", function() {
            timerStop = true;
            var indexNum = $(this).attr("data-index");
            if (indexNum === questionBank[quesNumCounter].answerIndex) {
                winScreen(indexNum, true);
            } else {
                winScreen(indexNum, false);
            }

        });


        //generates the questions and answers
        function generateQuestion(quesNum, correct) {
            var question = questionBank[quesNum]
            $question.text(question.questionString)
            $("li").remove();
            for (i = 0; i < question.answerChoices.length; i++) {
                $answers.append("<li data-index=" + "'" + i + "''>" + question.answerChoices[i] + "</li>")
            }
        }

        //display if player is correct
        function winScreen(indexNum, correct) {
            $wrapper.hide();
            if (correct) {
                $("#info-panel").html("<h2> Your answer of " + questionBank[quesNumCounter].answerChoices[indexNum] + " is correct")
                correctGuess++;

            } else {
                var indexShort = questionBank[quesNumCounter].answerIndex
                $("#info-panel").html("<h2> Your answer of " + questionBank[quesNumCounter].answerChoices[indexNum] + " is wrong</h2><h2> The correct answer is " + questionBank[quesNumCounter].answerChoices[indexShort] + "<h2>")
                incorrectGuess++;
            }
            $("#info-panel").show();
            setTimeout(nextQuestion, 2000);
        }

        function timeUp() {
            $wrapper.hide();
            var indexShort = questionBank[quesNumCounter].answerIndex
            $("#info-panel").html("<h2>Time has run out!<h2><h2> The correct answer is " + questionBank[quesNumCounter].answerChoices[indexShort] + "<h2>")
            unansweredGuess++;
            $("#info-panel").show();
            setTimeout(nextQuestion, 2000);
        }

        function endScreen() {
            $("#info-panel").html("<h2>Here are your results!<h2><h2>Correct: " + correctGuess + "</h2>" + "<h2>Incorrect: " + incorrectGuess + "</h2><h2>Unanswered: " + unansweredGuess + "</h2>")
            $start.show();
            $start.text("Play Again");
            $("#info-panel").show();

        }


    });



    </script>
</body>

</html>
